<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<title>Bach-machine</title>
	<link href="styles/style.css" rel="stylesheet" type="text/css">
</head>

<body>

	<div class="content">
		
		<div class="title">
			<h1>Bach-machine</h1>
			<p>Su generador inteligente de corales</p>
		</div>
		
<!-- 		<div class="flex-button-bar">
		
		  <button class="button" onclick="loadHome()">Inicio</button>
		  <button class="button" onclick="loadPrologFile()">Código Prolog</button>
		  <button class="button" onclick="location.href='https://github.com/balath/balath.github.io/raw/master/files/memoria.pdf';">Memoria</button>
		  
		</div> -->
	
		<div id="home-msg" align="center">
			<br>
			<form id="tono" action="prolog.js">
			  <br><br>
			  <label for="tonos">Tono del Coral:</label> 
			  <select class="select" id="tonos">
				<option aria-label="do" value="c" selected>Do</option>
				<option aria-label="do sostenido" value="cis">Do♯</option>
				<option aria-label="re bemol" value="des">Re♭</option>
				<option aria-label="re" value="d">Re</option>
				<option aria-label="mi bemol" value="ees">Mi♭</option> 
				<option aria-label="mi" value="e">Mi</option>
				<option aria-label="fa" value="f">Fa</option>
				<option aria-label="fa sostenido" value="fis">Fa♯</option>
				<option aria-label="sol bemol" value="ges">Sol♭</option>
				<option aria-label="sol" value="g">Sol</option>
				<option aria-label="la bemol" value="aes">La♭</option>
				<option aria-label="la" value="a">La</option>
				<option aria-label="si bemol" value="bis">Si♭</option>
				<option aria-label="si" value="b">Si</option>
			  </select>
			  <br><br>
			  <label for="modo">Modo:</label> 
			  <select class="select" id="modo">
				<option value="major" selected>Mayor</option>
				<option value="minor">Menor</option>
			  </select>
			  <br><br>
			  <input class="select" type="button" value="Generar" onclick="generate()">
			</form>
			<br>
		</div>
		
		<div class="flex-content" id="cont"></div>

	</div>

	<script src="scripts/tau-prolog.js"></script>
	<script src="scripts/prologString.js"></script>
	<script src="scripts/main.js"></script>
    <script>
        function generate() {
            const key = document.getElementById('tonos').value;
            const mode = document.getElementById('modo').value;
            const url = `https://71f0-84-122-116-223.ngrok-free.app/choral/${key}/${mode}`;

            fetch(url, {
                method: 'GET',
            })
            .then(response => response.json())
            .then(data => {
                const pdfId = data.pdf;
                const midiId = data.midi;

                // Construir URLs
                const pdfUrl = `https://71f0-84-122-116-223.ngrok-free.app/pdf/${pdfId}`;
                const midiUrl = `https://71f0-84-122-116-223.ngrok-free.app/midi/${midiId}`;

                // Crear elementos para mostrar el PDF y descargar el MIDI
                const pdfIframe = `<iframe src="${pdfUrl}" width="100%" height="600px"></iframe>`;
                const midiLink = `<a href="${midiUrl}" download="choral.mid">Descargar archivo MIDI</a>`;

                // Mostrar resultados en el contenedor
                document.getElementById('cont').innerHTML = `<div>${pdfIframe}</div><div>${midiLink}</div>`;
            })
            .catch(error => {
		    document.getElementById('cont').innerHTML = `<div style="color: red;">${error.message}</div>`;
	    });
        }
    </script>
	<br><br>
</body>

<footer>
  <a href="mailto:sergio-flor@outlook.es"><img alt="Mail" src="files/mail32.png"></a>
  <a href="http://tau-prolog.org/"><img alt="Tau-Prolog website" src="files/tauprolog32.png"></a>
  <a href="https://twitter.com/balath83"><img alt="Twitter" src="files/twitter32.png"></a>  
</footer>

</html>
